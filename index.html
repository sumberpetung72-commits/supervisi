<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ceklis Supervisi - SMPN 2 KALIPARE</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --primary: #2c3e50; --accent: #27ae60; --margin: 20mm; }
        body { font-family: 'Times New Roman', Times, serif; background-color: #525659; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .page { width: 210mm; min-height: 297mm; padding: var(--margin); background: white; box-shadow: 0 0 10px rgba(0,0,0,0.5); box-sizing: border-box; }
        .controls { width: 210mm; background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        
        /* Kop Surat */
        .kop-surat { display: flex; align-items: center; border-bottom: 4px double #000; padding-bottom: 10px; margin-bottom: 20px; text-align: center; }
        #logo-preview { width: 80px; height: 80px; object-fit: contain; margin-right: 15px; }
        .kop-text { flex-grow: 1; margin-right: 80px; }
        .kop-text p { margin: 0; font-size: 14pt; font-weight: bold; }
        .kop-text h2 { margin: 0; font-size: 16pt; text-transform: uppercase; }
        .kop-text span { font-size: 9pt; }

        /* Form */
        .info-table { width: 100%; margin-bottom: 15px; border: none; }
        .info-table td { padding: 4px; border: none; font-size: 11pt; }
        select, input { width: 100%; border: none; border-bottom: 1px dotted #000; font-family: inherit; font-size: 11pt; outline: none; background: transparent; }

        /* Progress Bar */
        .prog-container { width: 100%; background: #eee; height: 10px; border-radius: 5px; margin: 10px 0; overflow: hidden; }
        #bar { height: 100%; background: var(--accent); width: 0%; transition: 0.3s; }

        table.main-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        table.main-table th, table.main-table td { border: 1px solid black; padding: 6px; font-size: 11pt; }
        table.main-table th { background: #f2f2f2; }
        .center { text-align: center; }

        .footer { margin-top: 30px; display: flex; justify-content: space-between; text-align: center; }
        .footer div { width: 250px; }
        .btn-unduh { background: var(--accent); color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        @media print { .no-print { display: none !important; } .page { box-shadow: none; margin: 0; width: 100%; } }
    </style>
</head>
<body>

<div class="controls no-print">
    <div>
        <label>Logo Sekolah: </label>
        <input type="file" id="logo-input" accept="image/*" style="width: auto; border: none;">
    </div>
    <button class="btn-unduh" onclick="downloadPDF()">ðŸ’¾ UNDUH PDF</button>
</div>

<div class="page" id="document">
    <div class="kop-surat">
        <img id="logo-preview" src="https://via.placeholder.com/80?text=LOGO" alt="Logo">
        <div class="kop-text">
            <p>PEMERINTAH KABUPATEN MALANG</p>
            <p>DINAS PENDIDIKAN</p>
            <h2>SMP NEGERI 2 KALIPARE</h2>
            <span>Jalan Raya Banduarjo No. 1099 Sumberpetung Kab. Malang, Kode Pos 65166</span>
        </div>
    </div>

    <h3 style="text-align: center; text-decoration: underline;">CEKLIS KELENGKAPAN ADMINISTRASI GURU</h3>

    <div class="prog-container no-print">
        <div id="bar"></div>
    </div>

    <table class="info-table">
        <tr>
            <td width="20%">Nama Guru</td><td width="2%">:</td>
            <td>
                <select id="guru-select" onchange="updateNip()">
                    <option value="">-- Pilih Nama Guru --</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>NIP</td><td>:</td>
            <td><span id="nip-display">..........................................</span></td>
        </tr>
        <tr>
            <td>Mata Pelajaran</td><td>:</td>
            <td><input type="text" placeholder="Masukkan Mata Pelajaran..."></td>
        </tr>
        <tr>
            <td>Kelas/Semester</td><td>:</td>
            <td><input type="text" placeholder="VII / Ganjil"></td>
        </tr>
    </table>

    <table class="main-table">
        <thead>
            <tr>
                <th width="5%">No</th>
                <th width="75%">Komponen Administrasi</th>
                <th width="20%">Status (Ada)</th>
            </tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>

    <div class="footer">
        <div>
            <p>Mengetahui,</p>
            <p>Kepala Sekolah</p>
            <br><br><br>
            <p><strong>ELISABET DWI BUDIATI, S.Pd</strong><br>NIP. 197507312002122005</p>
        </div>
        <div>
            <p>Kalipare, ........................... 2026</p>
            <p>Guru Mata Pelajaran</p>
            <br><br><br>
            <p><strong id="guru-name-footer">____________________</strong><br><span id="guru-nip-footer">NIP. ..........................................</span></p>
        </div>
    </div>
</div>

<script>
    // Data Guru sesuai file PDF yang diunggah
    const dataGuru = [
        { nama: "SULISTIONO, S.Pd", nip: "197209232006041007" },
        { nama: "NOVITA K. M., S.Pd., M.Pd", nip: "198204292009042004" },
        { nama: "SUTONO, S.Pd", nip: "196806102008011019" },
        { nama: "BAMBANG RUDI S., S. Pd", nip: "196712132008011003" },
        { nama: "Dra. RIBUATI", nip: "196711022014082001" },
        { nama: "LILIS SETYOWATI, S.Pd", nip: "197803042014082002" },
        { nama: "ABDUL ROHIM, S.Ag", nip: "196901162021211003" },
        { nama: "SUGIANTO, S.Pd", nip: "197107012021211006" },
        { nama: "SUSMINING HARTINI, S.Pd", nip: "197011182022212001" },
        { nama: "DWI SUSANTI, S.Pd", nip: "199007032023212035" },
        { nama: "NOVA AGUSTINA, S.E., Gr", nip: "199508112024212049" },
        { nama: "IMA ROTUL FAUDAH, S.Pd.I", nip: "-" }
    ];

    const checklistItems = [
        "Kalender Pendidikan", "Program Tahunan", "Program Semester",
        "Silabus / ATP", "RPP / Modul Ajar", "Jadwal Pelajaran",
        "Buku Absensi Siswa", "Buku Daftar Nilai", "KKM / KKTP",
        "Buku Agenda Guru", "Analisis Hasil Evaluasi", "Program Perbaikan & Pengayaan"
    ];

    // Inisialisasi Dropdown Guru
    const select = document.getElementById('guru-select');
    dataGuru.forEach(g => {
        let opt = document.createElement('option');
        opt.value = g.nip;
        opt.text = g.nama;
        select.add(opt);
    });

    // Inisialisasi Tabel Ceklis
    const tbody = document.getElementById('table-body');
    checklistItems.forEach((item, i) => {
        tbody.innerHTML += `<tr><td class="center">${i+1}</td><td>${item}</td><td class="center"><input type="checkbox" class="chk" onchange="calc()"></td></tr>`;
    });

    // Fungsi Update Identitas di Tabel & Tanda Tangan
    function updateNip() {
        const selectedOpt = select.options[select.selectedIndex];
        const nipVal = selectedOpt.value;
        const namaVal = selectedOpt.text;

        // Update di bagian info atas
        document.getElementById('nip-display').innerText = nipVal || "..........................................";
        
        // Update di bagian tanda tangan
        if (select.value === "") {
            document.getElementById('guru-name-footer').innerText = "____________________";
            document.getElementById('guru-nip-footer').innerText = "NIP. ..........................................";
        } else {
            document.getElementById('guru-name-footer').innerText = namaVal;
            document.getElementById('guru-nip-footer').innerText = "NIP. " + nipVal;
        }
    }

    // Handler Upload Logo
    document.getElementById('logo-input').addEventListener('change', function(e) {
        const reader = new FileReader();
        reader.onload = function() { document.getElementById('logo-preview').src = reader.result; }
        reader.readAsDataURL(e.target.files[0]);
    });

    // Kalkulasi Progress Bar
    function calc() {
        const total = document.querySelectorAll('.chk').length;
        const checked = document.querySelectorAll('.chk:checked').length;
        document.getElementById('bar').style.width = Math.round((checked / total) * 100) + '%';
    }

    // Fungsi Export ke PDF
    function downloadPDF() {
        const element = document.getElementById('document');
        html2pdf().set({
            margin: 0,
            filename: 'Ceklis_Administrasi_SMPN2.pdf',
            image: { type: 'jpeg', quality: 1 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        }).from(element).save();
    }
</script>
</body>
</html>
